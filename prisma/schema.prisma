generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model League {
  id      Int      @id @default(autoincrement())
  name    String
  status  String   @default("Active")
  goals   Goal[]
  matches Match[]
  players Player[]
  teams   Team[]
}

model Team {
  id             Int      @id @default(autoincrement())
  name           String
  leagueId       Int
  code           String?
  league         League   @relation(fields: [leagueId], references: [id], onDelete: Cascade)
  goalsAgainst   Goal[]   @relation("receiver")
  goalsInFavor   Goal[]   @relation("scorer")
  matchesAsTeam2 Match[]  @relation("team2")
  matchesAsTeam1 Match[]  @relation("team1")
  players        Player[]
}

model Player {
  id       Int    @id @default(autoincrement())
  name     String
  lastName String
  number   Int
  leagueId Int
  teamId   Int
  league   League @relation(fields: [leagueId], references: [id], onDelete: Cascade)
  team     Team   @relation(fields: [teamId], references: [id], onDelete: Cascade)
  goals    Goal[]
}

model Match {
  id       Int    @id @default(autoincrement())
  leagueId Int
  homeId   Int
  awayId   Int
  result   Int    @default(-1)
  status   String @default("Pendant")
  matchday Int
  date     String @default("2022-03-17T19:00:00Z")
  away     Team   @relation("team2", fields: [awayId], references: [id])
  home     Team   @relation("team1", fields: [homeId], references: [id])
  league   League @relation(fields: [leagueId], references: [id], onDelete: Cascade)
  goals    Goal[]
}

model Goal {
  id         Int    @id @default(autoincrement())
  leagueId   Int
  matchId    Int
  playerId   Int
  teamId     Int
  receiverId Int
  quantity   Int    @default(0)
  league     League @relation(fields: [leagueId], references: [id], onDelete: Cascade)
  match      Match  @relation(fields: [matchId], references: [id], onDelete: Cascade)
  player     Player @relation(fields: [playerId], references: [id])
  receiver   Team   @relation("receiver", fields: [receiverId], references: [id])
  team       Team   @relation("scorer", fields: [teamId], references: [id])
}
